---
title: "Homework 2"
output: html_document
---

I'm an R Markdown document! 

# Problem 1

```{r}
library(tidyverse)
library(readxl)
```
```{r}
pols_df = read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/pols-month.csv")
snp_df = read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/snp.csv")
unemployment_df = read_csv("./fivethirtyeight_datasets/fivethirtyeight_datasets/unemployment.csv")
```

```{r}

separate_pols_df =
  
  separate(pols_df, mon, into = c("Year", "month", "day"), sep = "-")

integer_pols_df =
  mutate(separate_pols_df,
         Year = strtoi(Year),
         month = strtoi(month),
         day = strtoi(day))

month_name_pols_df = 
  mutate(integer_pols_df, month = month.abb[month])

president_pols_df = mutate(month_name_pols_df, 
                           president = case_when(
                             prez_dem == 1 ~ "gop",
                             prez_gop == 1 ~ "dem"
                           ))

clean_pols_df = select(president_pols_df, -day, -prez_dem, -prez_gop)

```

```{r}
separate_snp_df =
  
  separate(snp_df, date, into = c("Year", "month", "day"), sep = "-")

integer_snp_df =
  mutate(separate_snp_df,
         Year = strtoi(Year),
         month = strtoi(month),
         day = strtoi(day))

month_name_snp_df = 
  mutate(integer_snp_df, month = month.abb[month])

clean_snp_df = select(month_name_snp_df, -day)

arranged_snp_df = arrange(clean_snp_df, Year, month)
```

```{r}
pivot_unemployment_df = 
  pivot_longer(
    unemployment_df, Jan:Dec, 
    names_to = "month",
    values_to = "unemployment_rate"
  )

clean_unemployment_df = arrange(pivot_unemployment_df, Year, month)
```

```{r}
first_merged_df = left_join(clean_pols_df , arranged_snp_df, by = c("Year", "month"))
final_merged_df = left_join(clean_unemployment_df, first_merged_df, by = c("Year", "month"))

final_merged_df
```

#problem 2

```{r}
mr_trash_wheel_df = read_excel("./fivethirtyeight_datasets/202409 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", range = "A2:N655")

mr_trash_wheel_omit_df = drop_na(mr_trash_wheel_df, Dumpster)

almost_mr_trash_wheel_df = mutate(mr_trash_wheel_omit_df, `Sports Balls` = as.integer(round(`Sports Balls`, 0)))

without_name_mr_trash_wheel_df = mutate(almost_mr_trash_wheel_df, Year = as.integer(Year))

clean_mr_trash_wheel_df = mutate(without_name_mr_trash_wheel_df, Sheet = "Mr. Trash Wheel")
```

```{r}
professor_trash_wheel_df = read_excel("./fivethirtyeight_datasets/202409 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", range = "A2:M123")

professor_trash_wheel_omit_df = drop_na(professor_trash_wheel_df, Dumpster)

without_professor_trash_wheel_df = mutate(professor_trash_wheel_omit_df, Year = as.integer(Year))

clean_professor_trash_wheel_df = mutate(without_professor_trash_wheel_df, Sheet = "Professor Trash Wheel")
```

```{r}
Gwynnda_trash_wheel_df = read_excel("./fivethirtyeight_datasets/202409 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", range = "A2:L266")

Gwynnda_trash_wheel_omit_df = drop_na(Gwynnda_trash_wheel_df, Dumpster)

without_Gwynnda_trash_wheel_df = mutate(Gwynnda_trash_wheel_omit_df, Year = as.integer(Year))

clean_Gwynnda_trash_wheel_df = mutate(without_Gwynnda_trash_wheel_df, Sheet = "Gwynnda Trash Wheel")
```

```{r}
merged_data_trash_wheel_1 = left_join(clean_mr_trash_wheel_df, clean_professor_trash_wheel_df)
merged_data_trash_wheel_2 = left_join(merged_data_trash_wheel_1, clean_Gwynnda_trash_wheel_df)

merged_data_trash_wheel_final = select(merged_data_trash_wheel_2, Sheet, everything())

merged_data_trash_wheel_final
```

